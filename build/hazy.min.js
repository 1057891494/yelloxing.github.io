/*!
* yelloxing.github.io 云笔记-遇见更好的你 2.0.1 hazy
* https://yelloxing.github.io
* 
* Copyright 心叶 and other contributors
* 
* Released under the Apache-2.0
* 
* 云笔记-遇见更好的你V2
* 
* Date: 2017-10-27
*/

!function(e,t,n){"use strict";if(!e||!e.document)throw new Error("Hazy requires a window with a document!");var r=(new Date).getTime();t(e);var o=(new Date).getTime()-r;console.log("%c"+new Date+"\n\n心叶提示：系统启动用时为："+o+"毫秒\n\n","color:#daaa65")}(window,function(e){"use strict";var t=function(e,n){return new t.prototype.init(e,n)};t.prototype.init=function(r,o,i){i=i||n,o=o?t(o)[0]:document,this.length=0,this.context=o,this.selector=r;var c,l;if(!r)return this;if("body"==r)return this.context=document,this[0]=document.body,this.isTouch=!0,this.length=1,this;if(r===e)return this.context=document,this[0]=e,this.isTouch=!0,this.length=1,this;if("string"==typeof r){if(t.isHtmlTemplate(r)){var s=document.createElement("div");return s.innerHTML=r,this[0]=s.childNodes[0],this.isTouch=!0,this.length=1,this.context=void 0,this}if(t.isCssSelect(r)){this.isTouch=!0;var a,u;if(/^#[_\w$](?:[_\w\d$]|-)*$/.test(r))!(a=o.getElementById(r.replace(/^#/,"")))||1!==a.nodeType&&11!==a.nodeType&&9!==a.nodeType?this.length=0:(this[0]=a,this.length=1);else if(/\*/.test(r)){for(u=o.getElementsByTagName("*"),c=0,l=0;c<u.length;c++)1!==(a=u[c]).nodeType&&11!==a.nodeType&&9!==a.nodeType||(this[l]=a,l+=1);this.length=l}else if(/^[_\w$](?:[_\w\d$]|-)*$/.test(r)){for(u=o.getElementsByTagName(r),c=0,l=0;c<u.length;c++)1!==(a=u[c]).nodeType&&11!==a.nodeType&&9!==a.nodeType||(this[l]=a,l+=1);this.length=l}else if(/^\[.+\]$/.test(r)){var d=o.getElementsByTagName("*");for(r=r.replace(/^\[/,"").replace(/\]$/,""),this.length=0,c=0;c<d.length;c++)1!==(a=d[c]).nodeType&&11!==a.nodeType&&9!==a.nodeType||(""==t(a).attr(r)||t(a).attr(r))&&(this[this.length]=a,this.length+=1)}return this}throw new Error("["+r+"]Illegal argument value！")}if(1===r.nodeType||11===r.nodeType||9===r.nodeType)return this.context=o,this[0]=r,this.isTouch=!0,this.length=1,this;if("function"==typeof r)return t.__isLoad__?r():document.addEventListener?document.addEventListener("DOMContentLoaded",function e(){document.removeEventListener("DOMContentLoaded",e,!1),r(),t.__isLoad__=!0}):document.attachEvent&&document.attachEvent("onreadystatechange",function e(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",e),r(),t.__isLoad__=!0)}),this;if(r.isTouch){for(this.isTouch=!0,c=0;c<r.length;c++)this[c]=r[c];return this.context=r.context||o,this.length=r.length,this.selector=r.selector,this}return this};var n=t(document);t.prototype.extend=t.extend=function(){var e=arguments[0]||{},t=arguments[1]||{};1===arguments.length&&(t=e,e=this),"object"!=typeof e&&"function"!=typeof e&&(e={});for(var n in t)try{e[n]=t[n],/^hazy-/.test(n)&&document.createElement(n)}catch(e){throw new Error("Illegal property value！")}return e},t.innerObject={},t.innerObject.component={},t.looper={},t.looper.task=[],t.looper.isRun=!1,t.clock={},t.clock.timers=[],t.clock.interval=13,t.clock.speeds=400,t.clock.timerId=null,t.routerStyle={},t.scope={},document.createElement("hazy-view"),t.prototype.init.prototype=t.prototype,t.__isLoad__=!1,e.Hazy=e.$=t,console.log("%c"+new Date+"\n\n心叶提示：系统启动成功\n\n","color:#daaa65"),t.extend({isHtmlTemplate:function(e){return e=e.trim().replace(/[\n\f\r ]/g,""),!!/^<([^<> ]+).*>.*<\/\1>$/.test(e)||!!/^<!--.*-->$/.test(e)},isCssSelect:function(e){return!!/^#?[_\w$](?:[_\w\d$]|-)*$/.test(e)||(!!/^\[.+\]$/.test(e)||!!/\*/.test(e))}}),t.extend({outerHTML:function(e){return e.outerHTML||function(e){var t,n=document.createElement("div");return n.appendChild(e),t=n.innerHTML,n=null,t}(e)},uniqueClass:function(){for(var e="",t=0;t<arguments.length;t++){if("string"!=typeof arguments[t])throw new Error("Only string is valid,not project!");e+=arguments[t]+" "}var n={};(e=e.trim()).split(/ +/).forEach(function(e){n[e]=!0},this),e="";for(var r in n)n[r]&&(e+=r+" ");return e.trim()},operateClass:function(e,t,n){if("string"!=typeof e||"string"!=typeof t)throw new Error("Only string is valid,not project!");e=e.trim(),t=t.trim();var r=e.split(/ +/),o=t.split(/ +/),i={};r.forEach(function(e){i[e]=!0},this),o.forEach(function(e){i[e]=!n&&!i[e]},this);var c="";for(var l in i)i[l]&&(c+=l+" ");return c.trim()},getXHR:function(){var n=t.innerObject.xmlhttp;return n||(n=e.XMLHttpRequest?new e.XMLHttpRequest:new e.ActiveXObject("Microsoft.XMLHTTP"),t.innerObject.xmlhttp=n,n)}}),t.extend({compiler:function(e){var n,r,o,i,c=t.innerObject.component;for(n in c){switch(c[n][0].selector+""){case"E":o=t(n,e);break;case"A":o=t("["+n+"]",e);break;default:o=t(n,e)}for(r=0;r<o.length;r++){if((i=t(o[r])).attr(n+"-compiler"))throw new Error(n+" had compiler");var l=i.attr("data")||"";c[n][1](i,l,function(){var e,n,r=i.parents();for(e=0;e<r.length;e++)if((n=t(r[e]).attr("scope"))&&t(r[e]).attr("hazy-controller-compiler"))return n}()),i.attr(n+"-compiler",new Date),i.prepend("\x3c!--"+n+" Begin 【走一步 再走一步】--\x3e"),i.append("\x3c!--"+n+" End 【走一步 再走一步】--\x3e")}}c=null,n=null,o=null,i=null}}),t.prototype.extend({bind:function(n,r,o){var i=t(this);return e.attachEvent?i[0].attachEvent("on"+n,r):(o=o||!1,i[0].addEventListener(n,r,o)),i},unbind:function(n,r,o){var i=t(this);return e.detachEvent?i[0].detachEvent("on"+n,r):(o=o||!1,i[0].removeEventListener(n,r,o)),i}}),t.prototype.extend({html:function(e){var n=t(this);return""==e||e?(n[0].innerHTML=e,n):n[0].innerHTML},text:function(e){var n=t(this);return e?(n[0].innerText=e,n):n[0].innerText},val:function(e){var n=t(this);return e?(n[0].value=e,n):n[0].value},attr:function(e,n){var r=t(this);return n?(r[0].setAttribute(e,n),r):r[0].getAttribute(e)},addClass:function(e){var n=t(this);if("string"==typeof e&&e)for(var r,o=0,i=n[o];i;){r=i.getAttribute("class")||"";var c=t.uniqueClass(r,e);i.setAttribute("class",c),i=n[o],o+=1}return n},removeClass:function(e){var n=t(this);if("string"==typeof e&&e)for(var r,o=0,i=n[o];i;){r=i.getAttribute("class")||"";var c=t.operateClass(r,e,!0);i.setAttribute("class",c),i=n[o],o+=1}return n},toggleClass:function(e){var n=t(this);if("string"==typeof e&&e)for(var r,o=0,i=n[o];i;){r=i.getAttribute("class")||"";var c=t.operateClass(r,e);i.setAttribute("class",c),i=n[o],o+=1}return n},class:function(e){var n=t(this);if("string"!=typeof e||!e)return n[0].getAttribute("class")||"";for(var r=0,o=n[r];o;)o.setAttribute("class",t.uniqueClass(e)),o=n[r],r+=1;return n},css:function(e,n){var r=t(this);if("string"==typeof e&&1===arguments.length)return r[0].style[e];if("string"==typeof e&&"string"==typeof n)r[0].style[e]=n;else{if("object"!=typeof e)throw new Error("Not acceptable type!");for(var o in e)r[0].style[o]=e[o]}return r},append:function(e){var n=t(this);if(1===e.nodeType||11===e.nodeType||9===e.nodeType)n[0].appendChild(e);else if(e.isTouch)n[0].appendChild(e[0]);else{if("string"!=typeof e)throw new Error("Not acceptable type!");n[0].appendChild(t(e)[0])}return n},prepend:function(e){var n=t(this);if(1===e.nodeType||11===e.nodeType||9===e.nodeType)n[0].insertBefore(e,n[0].childNodes[0]);else if(e.isTouch)n[0].insertBefore(e[0],n[0].childNodes[0]);else{if("string"!=typeof e)throw new Error("Not acceptable type!");n[0].insertBefore(t(e)[0],n[0].childNodes[0])}return n},after:function(e){var n=t(this),r=n[0].parentNode||t("body")[0];if(1===e.nodeType||11===e.nodeType||9===e.nodeType)r.insertBefore(e,n[0].nextSibling);else if(e.isTouch)r.insertBefore(e[0],n[0].nextSibling);else{if("string"!=typeof e)throw new Error("Not acceptable type!");r.insertBefore(t(e)[0],n[0].nextSibling)}return n},before:function(e){var n=t(this),r=n[0].parentNode||t("body")[0];if(1===e.nodeType||11===e.nodeType||9===e.nodeType)r.insertBefore(e,n[0]);else if(e.isTouch)r.insertBefore(e[0],n[0]);else{if("string"!=typeof e)throw new Error("Not acceptable type!");r.insertBefore(t(e)[0],n[0])}return n},remove:function(){var e=t(this);return(e[0].parentNode||t("body")[0]).removeChild(e[0]),e},empty:function(){var e=t(this);return e.html(""),e}}),t.prototype.extend({parent:function(){for(var e,n=t(this),r=0,o=n[r];o;){e=o;do{(e=e.parentNode)&&1===e.nodeType?n[r]=e:n[r]=null}while(e.parentNode&&!n[r]);o=n[r+=1]}return n.selector=n.selector+":parent",n},parents:function(){var e=t(this),n=e[0];e.length=0;do{(n=n.parentNode)&&1===n.nodeType&&(e[e.length]=n,e.length+=1)}while(n);return e.selector=e.selector+":parents",e},children:function(){var e=t(this),n=e[0].childNodes,r=0,o=n[r];for(e.length=0;o;)o&&1===o.nodeType&&(e[e.length]=o,e.length++),o=n[r+=1];return e.selector=e.selector+":children",e},siblings:function(){var e=t(this),n=e.parent();return e.selector=e.selector+":siblings",t(n[0]).children()},next:function(){for(var e,n=t(this),r=0,o=n[r];o;){e=o;do{(e=e.nextSibling)&&1===e.nodeType?n[r]=e:n[r]=null}while(e.nextSibling&&!n[r]);o=n[r+=1]}return n.selector=n.selector+":next",n},nextAll:function(){var e=t(this),n=e[0];e.length=0;do{(n=n.nextSibling)&&1===n.nodeType&&(e[e.length]=n,e.length+=1)}while(n);return e.selector=e.selector+":nextAll",e},prev:function(){for(var e,n=t(this),r=0,o=n[r];o;){e=o;do{(e=e.previousSibling)&&1===e.nodeType?n[r]=e:n[r]=null}while(e.previousSibling&&!n[r]);o=n[r+=1]}return n.selector=n.selector+":prev",n},prevAll:function(){var e=t(this),n=e[0];e.length=0;do{(n=n.previousSibling)&&1===n.nodeType&&(e[e.length]=n,e.length+=1)}while(n);return e.selector=e.selector+":prevAll",e},find:function(e){var n=t(this);return t(e,n[0])},first:function(){var e=t(this);return e[0]?e.length=1:e.length=0,e.selector=e.selector+":first",e},last:function(){var e=t(this);return e[e.length-1]?(e[0]=e[e.length-1],e.length=1):e.length=0,e.selector=e.selector+":last",e},eq:function(e){var n=t(this);return n[e]?(n[0]=n[e],n.length=1):n.length=0,n.selector=n.selector+":eq("+e+")",n},filter:function(e){for(var n=t(this),r=0,o=0;o<n.length;o++)e(t(n[o]))&&(n[r]=n[o],r+=1);return n.length=r,n.selector=n.selector+":filter("+e+")",n},not:function(e){for(var n=t(this),r=0,o=0;o<n.length;o++)e(t(n[o]))||(n[r]=n[o],r+=1);return n.length=r,n.selector=n.selector+":not("+e+")",n}}),t.extend({ajax:function(e,n,r,o){var i=t.getXHR();i.onreadystatechange=function(){4==this.readyState&&(200==this.status?r&&r(this.responseText):o&&o())},i.open(e,n+"?Token="+(new Date).valueOf(),!0),i.send()}}),t.prototype.extend({animation:function(e,n,r){var o=t(this);if(!e||"object"!=typeof e)throw new Error("protojson is illegal!");if("number"!=typeof n&&n)throw new Error("duration is illegal!");var i,c,l,s,a,u={};t.clock.timer(function(t){for(i in e){if(!u[i]){if(c=e[i],s=o.css(i),l={value:s.replace(/[pxrem%]/g,""),unit:s.replace(/[\d\.]/g,"")},!/^-*[\d\.]+px$/.test(c)||s&&"px"!=l.unit)if(!/^-*[\d\.]+%$/.test(c)||s&&"%"!=l.unit)if(!/^-*[\d\.]+$/.test(c)||s&&""!=l.unit)if(!/^-*[\d\.]+em$/.test(c)||s&&"em"!=l.unit){if(!/^-*[\d\.]+rem$/.test(c)||s&&"rem"!=l.unit)throw s=s||"undefined",new Error(c+" is illegal for animation,old value is "+s+"!");c=c.replace(/rem$/,""),a="rem"}else c=c.replace(/em$/,""),a="em";else a="";else c=c.replace(/%$/,""),a="%";else c=c.replace(/px$/,""),a="px";l.value=l.value||0,u[i]={deep:c-l.value,unit:a,beginValue:l.value},l=null}a=u[i].unit,c=u[i].beginValue- -u[i].deep*t*.01,o.css(i,c+""+a)}},n,r)}}),t.extend(t.clock,{timer:function(e,n,r){if(!e)throw new Error("tick is required!");n=n||t.clock.speeds,t.clock.timers.push({createTime:new Date,tick:e,duration:n,callback:r}),t.clock.start()},start:function(){t.clock.timerId||(t.clock.timerId=e.setInterval(t.clock.tick,t.clock.interval))},tick:function(){var e,n,r,o,i,c,l,s=t.clock.timers;for(t.clock.timers=[],t.clock.timers.length=0,n=0;n<s.length;n++)e=(i=s[n]).createTime,r=i.tick,c=i.duration,o=i.callback,!1,(l=(+new Date-e)/c)>=1&&!0,r(100*(l=l>1?1:l)),l<1?t.clock.timers.push(i):o&&o();t.clock.timers.length<=0&&t.clock.stop()},stop:function(){t.clock.timerId&&(e.clearInterval(t.clock.timerId),t.clock.timerId=null)}}),t.extend(t.looper,{loop:function(e){t.looper.task.unshift(e),t.looper.start()},start:function(){t.looper.isRun||(t.looper.isRun=!0,t.looper.do())},do:function(){t.looper.task.length<=0?t.looper.isRun=!1:(t.looper.task.pop()(),t.looper.do())}}),t.extend({startRouter:function(n){var r=(e.location.hash+"").split("?")[0].slice(1).match(/\/[^\/]+/g);r?t.initPage(1,r.length,r,"",n):e.location.href="/#"+n.default,t(e).bind("hashchange",function(){var r=(e.location.hash+"").split("?"),o=n[r[0].slice(1)]||n[n.default],i=(r[0].slice(1).match(/\/[^\/]+/g),o.src),c=o.deep||r[0].slice(1).replace(/[^\/]/g,"").length||1;i||(i=n.NotFound,c=1),t.ajax("get",i,function(n){try{t("hazy-view").eq(c-1).html(n),t.compiler(t("hazy-view")[c-1]),t.routerStyle.changeClick(r[0].slice(1).replace(/^.*\//,""),r[0].slice(1).replace(/[^\/]/g,"").length||1)}catch(t){e.location.reload()}},function(){throw new Error("Not Accepted Error!")})})},initPage:function(n,r,o,i,c){i+=o[n-1];var l=c[i]||c.NotFound,s=l.deep||n,a=l.src,u=!0;a||(a=c.NotFound,r=1,s=1,u=!1),t.ajax("get",a,function(l){if(t("hazy-view").eq(s-1).html(l),n<r&&u)t.initPage(n+1,r,o,i,c);else{var a=(e.location.hash+"").split("?");t.routerStyle.initClick(a[0].slice(1)),console.log("%c"+new Date+"\n\n心叶提示：路由恢复成功\n\n","color:#daaa65"),t.compiler(t("hazy-view")[0])}},function(){throw new Error("Not Accepted Error!")})}}),t.extend(t.scope,{data:{},initScope:function(e){this.data[e]={}},setScope:function(e,t,n){this.data[e][t]=n},getScope:function(e,t){return this.data[e][t]}}),t.extend({controller:function(e,n){t("[scope]").filter(function(r){if(t(r).attr("scope")==e){var o=t.scope.data[e];n(o)}})}}),t.extend({directive:function(e,n){var r=n(),o={};o[e]=[{selector:r.restrict},r.compile],t.extend(t.innerObject.component,o)}}),t.directive("hazy-copy",function(){return{restrict:"E",compile:function(e,n){e.prepend("<div class='hazy-copy-button'>\x3c!--copy--\x3e</div>"),n=JSON.parse(n);var r=t(n.selector);e.find("div").filter(function(e){return"hazy-copy-button"===e.class()}).bind("click",function(e){t.clipboard(r[n.type]())})}}}),t.directive("hazy-onLazyJs",function(){return{restrict:"E",compile:function(n,r){t.ajax("get",r,function(t){e.eval.call(e,t)})}}}),t.directive("hazy-controller",function(){return{restrict:"E",compile:function(e,n){e.attr("scope",n),t.scope.initScope(n)}}}),t.directive("xy-click",function(){return{restrict:"A",compile:function(e,n,r){var o=e.attr("xy-click").trim().replace(/\(.*\)$/,"").replace("$scope.","");e.bind("click",function(){t.scope.data[r][o]()})}}}),$.extend({getViewSize:function(){var t,n;return e.innerWidth?t=e.innerWidth:document.body&&document.body.clientWidth&&(t=document.body.clientWidth),e.innerHeight?n=e.innerHeight:document.body&&document.body.clientHeight&&(n=document.body.clientHeight),document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientWidth&&(n=document.documentElement.clientHeight,t=document.documentElement.clientWidth),{width:t,height:n}},notify:function(n){t.looper.loop(function(){var r=(new Date).valueOf();t("body").append(t('<div id="notify-'+r+'" class="notify">'+n+"</div>")),t("#notify-"+r).css({left:"100%"}).animation({left:"0%"},2e4,function(){e.setTimeout(function(){t("#notify-"+r).remove()},1e3)})})},clipboard:function(e){return t("body").append(t('<textarea id="clipboard-textarea">'+e+"</textarea>")),document.getElementById("clipboard-textarea").select(),document.execCommand("copy",!1,null),t("#clipboard-textarea").remove(),t.notify("复制成功，现在可以粘贴了"),this},cancelTabDafaultEvent:function(n,r){if(9==((r=r||e.event).keyCode||r.which)){if(!r.preventDefault)return r.returnValue=!1,!1;r.preventDefault(),r.stopPropagation(),t.addTextSpace(n)}},addTextSpace:function(e){}}),$.prototype.extend({getElementPosition:function(){var e=$(this),t=0,n=0,r=e[0];for(n=r.offsetTop,t=r.offsetLeft,r=r.offsetParent;r;)n+=r.offsetTop,t+=r.offsetLeft,r=r.offsetParent;return e.left=t,e.top=n,e}}),t.extend(t.routerStyle,{initClick:function(e){var n,r=e.replace(/^\//,"").split(/\//);for(n=0;n<r.length;n++)t.routerStyle.changeClick(r[n],n+1)},changeClick:function(e,t){var n;switch(t){case 1:(n={home:1,notebook:2,example:3,opensource:4}[e])&&$("#deeponemenu").length>0&&$("#deeponemenu").find("li").removeClass("click").eq(n-1).addClass("click");break;case 2:(n={tool:1,ECMAScript:2,css:3,enhanceCss:4}[e])&&$("#deeptwomenu").length>0&&$("#deeptwomenu").find("li").removeClass("click").eq(n-1).addClass("click")}}})});